package com.platform.common.utils;

import com.chinaums.pay.api.impl.DefaultSecurityService;
import com.platform.common.contants.Constants;

public class Yanqian {

	/**
	 * 测试客户端签名，服务端验签
	 */
	public static boolean testMerSignVerify(String data) {

		boolean verifyResult = false;

		String singKeyMod = "83beb97d3aa44b696b2e1633d6d6fe5ec2b86d2d8ba8437c5c4bcac0530b7d50f03af18dee28f7ebd8859d7063254f3751c1c3594a6146e430ea442489b8fb46dc38c34f42241b0783044b459ce8b377006bc7b1a3b58f41ad772ff65846f4946e9d68e1d78564f89b70b2c713c0e6efbb03100e317eb3214d9ed072fbee3a07";
		String singKeyExp = "1e4c5e9c4e403a97a3ee956c969c1b23efe43a379f46b33e867b67c59353b11e4c21422c41f96a0af360c7347198c2ff15ee59decf1c50116aae75bd716ef95a9dffd055bc872dc840a53f1d8fdbf08430efa394f8fe7ffc708ccbf4b9d46f6c833a415e57abd811d4b2b1aee64f59e1b87a74986fc7bd04514f924b5550a901";
		String verifyKeyMod = "83BEB97D3AA44B696B2E1633D6D6FE5EC2B86D2D8BA8437C5C4BCAC0530B7D50F03AF18DEE28F7EBD8859D7063254F3751C1C3594A6146E430EA442489B8FB46DC38C34F42241B0783044B459CE8B377006BC7B1A3B58F41AD772FF65846F4946E9D68E1D78564F89B70B2C713C0E6EFBB03100E317EB3214D9ED072FBEE3A07";
		String verifyKeyExp = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001";

		try {
			// 测试参数
			DefaultSecurityService ss = new DefaultSecurityService();
			// 设置签名的商户私钥，验签的银商公钥
			ss.setSignKeyModHex(singKeyMod);// 签名私钥 Mod
			ss.setSignKeyExpHex(singKeyExp);// 签名私钥 Exp
			ss.setVerifyKeyExpHex(verifyKeyExp);// 验签公钥 exp
			ss.setVerifyKeyModHex(verifyKeyMod);// 验签公钥 mod

			// 签名
			String sign = ss.sign(data);
			System.out.println("签名数据：" + sign);
			// 验签
			verifyResult = ss.verify(data, sign);

			System.out.println("验签结果:" + verifyResult);

		} catch (Exception e) {
			e.printStackTrace();
		}
		return verifyResult;
	}

	public static boolean merSignVerify(String data) {
//		String singKeyMod = "83beb97d3aa44b696b2e1633d6d6fe5ec2b86d2d8ba8437c5c4bcac0530b7d50f03af18dee28f7ebd8859d7063254f3751c1c3594a6146e430ea442489b8fb46dc38c34f42241b0783044b459ce8b377006bc7b1a3b58f41ad772ff65846f4946e9d68e1d78564f89b70b2c713c0e6efbb03100e317eb3214d9ed072fbee3a07";
//		String singKeyExp = "1e4c5e9c4e403a97a3ee956c969c1b23efe43a379f46b33e867b67c59353b11e4c21422c41f96a0af360c7347198c2ff15ee59decf1c50116aae75bd716ef95a9dffd055bc872dc840a53f1d8fdbf08430efa394f8fe7ffc708ccbf4b9d46f6c833a415e57abd811d4b2b1aee64f59e1b87a74986fc7bd04514f924b5550a901";
//		String verifyKeyMod = "83BEB97D3AA44B696B2E1633D6D6FE5EC2B86D2D8BA8437C5C4BCAC0530B7D50F03AF18DEE28F7EBD8859D7063254F3751C1C3594A6146E430EA442489B8FB46DC38C34F42241B0783044B459CE8B377006BC7B1A3B58F41AD772FF65846F4946E9D68E1D78564F89B70B2C713C0E6EFBB03100E317EB3214D9ED072FBEE3A07";
//		String verifyKeyExp = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001";
		
		String singKeyMod   = "b1edf6247df2d09d59f1666823bce2c64d4a35c8b5697f8078501a888f5b93ba2efa5169dd1e506abe30ec56bce821425a956bfa9944b627d96631ca501d9c5017a2e3a8e5ccbf3e720810c347780db87f78a7a40811654780f82a36b02c71ef00eeddb9a41bf53406ea064be969014c960cb9e89fcc0b894eef0e43e6c5d26b";
		String singKeyExp   = "68032a7ba4a0d830d3ce594611762ebf2b99711d766748a0aa34717e590778b1431b1392a62f3d6558ef328975fee0ca70379f1aac944d43b8439461a739d810c39358a888cbc9695885f64fbe5b76c8b1f97dc3d47d0f77642aef218388c66284573e238b6bda3139dea877fa167e2451ff97930cb17d507836ce7f31200451";
		String verifyKeyMod = "e186dec2f5995596a8c7f98e22686216f21b9eff254665bc0f7612eea2dd8b661da47e9a64df9773523b55418225dd766bda21a5599c09711ec63fd6c45477eda3bed077402d16369111634199836e955e7a1bc7fa6e6981c5b9d94fc0d632b99550bc91bb821661aff4de29306cd86a758389015c2bdd32bbcb985d999b08df";
		String verifyKeyExp = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001";

		boolean verifyResult = false;
		try {
			// 测试参数
			DefaultSecurityService ss = new DefaultSecurityService();
			// 设置签名的商户私钥，验签的银商公钥
			ss.setSignKeyModHex(singKeyMod);// 签名私钥 Mod
			ss.setSignKeyExpHex(singKeyExp);// 签名私钥 Exp
			ss.setVerifyKeyModHex(verifyKeyMod);// 验签公钥 mod
			ss.setVerifyKeyExpHex(verifyKeyExp);// 验签公钥 exp
			// 签名
			String sign = ss.sign(data);
			// 验签
			verifyResult = ss.verify(data, sign);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return verifyResult;
	}
}
